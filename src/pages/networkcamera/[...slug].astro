---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import SlugProductDetails from "../../components/SlugProductDetails.astro";

// Fetch all product entries and generate static paths
export async function getStaticPaths() {
  const productEntries = await getCollection("networkcamera");
  return productEntries.map((product) => ({
    params: { slug: product.slug },
    props: { product },
  }));
}

// Access the product data passed via props
const { product } = Astro.props;
// Generate structured data for the product
const structuredData = {
  "@context": "https://schema.org",
  "@type": "Product",
  name: product.data.title,
  description: product.data.subTitle,
  category: product.data.category,
  image: product.data.imgCard.src,
  title: `${product.data.title} | Hikvision Dubai`,
  // keywords: `${product.data.title}, ${product.data.subTitle}, ${product.data.category}, Hikvision Dubai, Hikvision Security Products, Hikvision Network Cameras, Hikvision NVR Systems, Hikvision PTZ Cameras, Hikvision CCTV Cameras, Hikvision Webcams, Hikvision Dubai Distributor, Hikvision Security Solutions, Hikvision Surveillance Equipment, Hikvision Dubai Security Systems, Hikvision Distributor Dubai, hikvision cctv in dubai, hikvision cctv in uae, hikvision cctv camera price in dubai, hikvision ip camera, hikvision dvr 4 channel, hikvision dvr 8 channel, hikvision wifi camera, hikvision ptz camera`,
  openGraph: {
    basic: {
      title: product.data.title,
      type: "product",
      image: product.data.imgCard.src,
      url: new URL(Astro.url.pathname, Astro.site).toString(),
    },
    optional: {
      description: product.data.subTitle,
      locale: "en_DUBAI",
      siteName: "Hikvision Dubai",
    },
    image: {
      alt: product.data.title,
    }
  },
  brand: {
    "@type": "Brand",
    name: "Hikvision Dubai",
  },
  offers: {
    "@type": "Offer",
    priceCurrency: "AED",
    availability: "https://schema.org/InStock",
    url: new URL(Astro.url.pathname, Astro.site).toString(),
  },
  aggregateRating: product.data.rating && product.data.reviewCount
    ? {
        "@type": "AggregateRating",
        ratingValue: product.data.rating.toFixed(1),
        reviewCount: product.data.reviewCount,
      }
    : undefined,
  manufacturer: {
    "@type": "Organization",
    name: "Hikvision Dubai",
  },
  sameAs: [
    "https://www.facebook.com/HikvisionDubai",
    "https://www.instagram.com/HikvisionDubai",
    "https://www.linkedin.com/company/hikvision-dubai",
  ],
  categoryHierarchy: [
    { "@type": "Thing", name: "CCTV Cameras" },
    { "@type": "Thing", name: product.data.category },
  ],
};

---

<Layout 
  title={structuredData.title} 
  description={structuredData.description}
  openGraph={structuredData.openGraph}
  structuredData={structuredData}
>
  <SlugProductDetails product={product} />
</Layout>